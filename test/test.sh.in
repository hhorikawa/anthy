#!/bin/sh

# Generate ruby module
#
# [usage]
#  *compile module
#   test.sh -compile
#  *invoke script
#   test.sh
#

srcdir=@top_srcdir@

testdir=${srcdir}/test/

case x$1 in
xcomp | xcompile | x-comp | x-compile | x--compile)
  swig -ruby -I${srcdir} ${srcdir}/test/anthy_swig.i

  # do not over write Makefile
  if test ! -d work; then
    mkdir work
  fi
  (cd work; CFLAGS=-I${srcdir} ruby ../${testdir}/extconf.rb)
  make -f work/Makefile
  exit;;
  *)
esac

LD_LIBRARY_PATH=../src-diclib/.libs:../src-main/.libs
export LD_LIBRARY_PATH

SRCDIR=$srcdir
export SRCDIR

ruby ${testdir}/test.rb
